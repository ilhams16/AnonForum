@{
	ViewData["Title"] = "Details";
}
@model AnonForum.MVC.Models.DetailsPostViewModel

<div class="mb-4">
	<div class="card">
		<div class="card-body text-center">
			<div class="d-flex justify-content-start align-content-center align-items-center">
				<div class="mx-1"><img src="/Image/UserImages/@Model.PostDetail.UserPost.UserImage" width="30" alt="User Image" /></div>
				<div class="mx-1">@Model.PostDetail.UserPost.Username</div>
			</div>
			<h5 class="card-title">@Model.PostDetail.Title</h5>
			<p class="card-text text-start">@Model.PostDetail.PostText</p>
			@if (!string.IsNullOrEmpty(@Model.PostDetail.Image))
			{
				<div class="m-auto">
					<img src="/Image/PostImages/@Model.PostDetail.Image" class="img-fluid rounded w-50 h-50" alt="Post Image" />
				</div>
			}
			<div class="d-flex justify-content-between mt-3">
				<p class="card-text"><strong>Category:</strong> @Model.PostDetail.Category.Name</p>
				<p class="card-text text-muted">Published on: @Model.PostDetail.TimeStamp.ToString("dddd, dd MMMM yyyy HH:m")</p>
			</div>
			<div class="d-flex m-2">
				<div class="d-flex m-2 align-items-center align-content-center">
					<button class="mx-1 btn btn-secondary">Like</button>
					<div class="mx-1 h4">@Model.PostDetail.TotalLikes</div>
				</div>
				<div class="d-flex mx-2 align-items-center align-content-center">
					<button class="mx-1 btn btn-secondary">Dislike</button>
					<div class="mx-1 h4">@Model.PostDetail.TotalDislikes</div>
				</div>
			</div>
			<div class="card-footer rounded-3">
				@if (Model.CommentsDetails != null)
				{
					var postComments = Model.CommentsDetails.Where(c => c.PostID == Model.PostDetail.PostID);
					if (postComments.Any())
					{
						@foreach (var comment in postComments)
						{
							<div class="border-bottom">
								<div class="d-flex m-2 justify-content-start align-items-center">
									<div class="mx-1 img-fluid"><img src="/Image/UserImages/@comment.UserImage" width="30" alt="User Image" /></div>
									<div class="mx-1 align-items-center align-content-center">@comment.Username</div>
								</div>
								<div class="d-block border rounded-3">
									<div class="text-start p-2 m-1">@comment.Comment</div>
									<div class="text-end text-muted">@comment.TimeStamp.ToString("dddd, dd MMMM yyyy HH:mm")</div>
								</div>
								<div class="d-flex m-2">
									<div class="d-flex m-2 align-items-center align-content-center">
										<button class="mx-1 btn btn-secondary btn-sm">Like</button>
										<div class="mx-1 h4">@comment.TotalLikes</div>
									</div>
									<div class="d-flex mx-2 align-items-center align-content-center">
										<button class="mx-1 btn btn-secondary btn-sm">Dislike</button>
										<div class="mx-1 h4">@comment.TotalDislikes</div>
									</div>
								</div>
							</div>
						}
					}
					else
					{
						<p>No comments for this post.</p>
					}
				}
				else
				{
					<p>No comments available.</p>
				}
			</div>
			<div class="mt-3 text-end">
				<a href="/Posts/Edit/@Model.PostDetail.PostID" class="btn btn-warning btn-sm mr-2">Edit</a>
				<a href="/Posts/Delete/@Model.PostDetail.PostID" class="btn btn-danger btn-sm">Delete</a>
			</div>
		</div>
	</div>
</div>